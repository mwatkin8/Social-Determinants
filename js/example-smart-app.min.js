/*!
 * Start Bootstrap - Social Determinants v1.0.0 ()
 * Copyright 2013-2020 UDBMI FHIR practicum
 * Licensed under  (https://github.com/BlackrockDigital/social-determinants/blob/master/LICENSE)
 */

!function(e){function y(e){return void 0!==e&&void 0!==e.valueQuantity&&void 0!==e.valueQuantity.value&&void 0!==e.valueQuantity.unit?e.valueQuantity.value+" "+e.valueQuantity.unit:void 0}e.extractData=function(){var h=$.Deferred();function o(){console.log("Loading error",arguments),h.reject()}return FHIR.oauth2.ready(function(m){if(m.hasOwnProperty("patient")){var e=m.patient,t=e.read(),a=m.patient.api.fetchAll({type:"Observation",query:{code:{$or:["http://loinc.org|26478-8","http://loinc.org|2345-7"]}}});console.log("patient:"),console.log(e),$.when(t,a).fail(o),$.when(t,a).done(function(e,t){var a=m.byCodes(t,"code");console.log("byCodes:"),console.log(a("26478-8")),console.log(a("2345-7"));var o=e.gender,l="",n="";void 0!==e.name[0]&&(l=e.name[0].given.join(" "),n=e.name[0].family);var i="",r="",d="",u="";void 0!==e.address[0]&&(i=e.address[0].line,r=e.address[0].city,d=e.address[0].state,u=e.address[0].postalCode);var s="",c="";void 0!==e.telecom[0]&&(s=e.telecom[0].value,c=e.telecom[1].value),lymph=a("26478-8");var v={fname:{value:""},lname:{value:""},gender:{value:""},birthdate:{value:""},lymph:{value:""},address:{value:""},phone:{value:""},email:{value:""},city:{value:""},country:{value:""},state:{value:""},zipcode:{value:""}};v.birthdate=e.birthDate,v.gender=o,v.fname=l,v.lname=n,v.address=i,v.phone=s,v.email=c,v.city=r,v.state=d,v.country=country,v.zipcode=u,v.lymph=y(lymph[0]),console.log("p:"),console.log(v),h.resolve(v)})}else o()},o),h.promise()},e.drawVisualization=function(e){$("#holder").show(),$("#loading").hide(),$("#fname").html(e.fname),$("#lname").html(e.lname),$("#gender").html(e.gender),$("#birthdate").html(e.birthdate),$("#lymph").html(e.lymph),$("#address").html(e.address),$("#phone").html(e.phone),$("#email").html(e.email),$("#city").html(e.city),$("#country").html(e.country),$("#state").html(e.state),$("#zipcode").html(e.zipcode)}}(window);